<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº’å‹•æ­·å²ï¼š17ä¸–ç´€çš„ç¦çˆ¾æ‘©æ²™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Formosan Earth (ç¦çˆ¾æ‘©æ²™å¤§åœ°) -->
    <!-- Application Structure Plan: The SPA is designed as a multi-faceted exploration tool, not a linear report. The structure uses a top navigation bar to switch between four main thematic sections: 1. **æ¢ç´¢æ™‚ä»£ (Timeline Explorer)**: A dynamic dashboard where users select a time period to see how different groups interacted and how the economy changed. This is the core interactive element, promoting discovery over passive reading. 2. **é—œéµå½±éŸ¿ (Key Impacts)**: A focused, tabbed section that breaks down the complex historical impacts into five digestible themes (Politics, Economy, Society, Culture, Environment), making abstract concepts easier to grasp. 3. **æ­·å²ç¾å ´ (Historic Sites)**: A virtual tour using interactive cards to connect historical events to real-world locations, fostering a sense of place and tangible connection to the past. 4. **è²¿æ˜“é¢¨é›² (Trading Game)**: A simple simulation game that embodies the "learning by doing" principle from the source report, allowing students to experience the economic challenges and opportunities of the era firsthand. This structure was chosen to cater to different learning stylesâ€”exploratory, analytical, visual, and kinestheticâ€”making the complex history of 17th-century Taiwan accessible and engaging for 5th graders. -->
    <!-- Visualization & Content Choices: 
        - **Timeline (HTML/CSS/JS)**: Goal: Organize/Change. A custom interactive timeline acts as the primary filter for the main dashboard. Interaction: Clicking a period updates the entire section. Justification: Provides a clear chronological framework for exploration.
        - **Trade Goods Chart (Chart.js Bar Chart)**: Goal: Compare/Change. Shows the relative importance of key exports (deer skin, sugar, rice). Interaction: Data updates based on the selected timeline period. Justification: Visually represents the economic core of the era and its shifts over time. Library: Chart.js for its simplicity and responsiveness.
        - **Impact Donut Charts (Chart.js Donut Chart)**: Goal: Inform. Used in the "Key Impacts" section to show simple proportions, e.g., the composition of different population groups. Interaction: Static display for quick comprehension. Justification: Breaks down complex data into simple, memorable visuals. Library: Chart.js.
        - **Perspective Cards (HTML/CSS/JS)**: Goal: Compare/Organize. Clickable cards for each major group (Dutch, Spanish, Indigenous, Han) that reveal their perspective. Interaction: Clicking a card updates a central text panel. Justification: Directly implements the report's emphasis on multi-perspective understanding.
        - **Historic Site Cards (HTML/CSS/JS)**: Goal: Organize. A grid of cards with hover and click effects. Interaction: Clicking reveals detailed information in a modal-like fashion. Justification: Creates an engaging "virtual tour" without needing a complex map library.
        - **Trading Game (HTML/CSS/JS)**: Goal: Inform/Engage (Simulation). A simple UI for a buy/sell game. Interaction: Users click buttons to trade and react to random events. Justification: A direct, gamified implementation of the report's teaching strategies, making economic concepts tangible.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFBF5; /* Warm Neutral Background */
            color: #4A4A4A;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active, .nav-link:hover {
            border-bottom-color: #D4A373; /* Accent Color */
            color: #A97C50;
        }
        .btn-primary {
            background-color: #A97C50; /* Muted Green/Brown */
            color: #FFFFFF;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #8C663F;
        }
        .card {
            background-color: #FFFFFF;
            border: 1px solid #EAEAEA;
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .tab-button.active {
            background-color: #D4A373;
            color: white;
        }
        .perspective-btn.active {
            background-color: #D4A373;
            color: white;
            transform: scale(1.05);
        }
        .timeline-segment.active {
            background-color: #A97C50;
        }
        .timeline-segment.active .timeline-year {
            color: white;
        }
        .timeline-segment.active .timeline-label {
            color: #FDFBF5;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-[#A97C50]">ğŸš¢ 17ä¸–ç´€çš„ç¦çˆ¾æ‘©æ²™</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#explore" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">æ¢ç´¢æ™‚ä»£</a>
                        <a href="#impacts" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">é—œéµå½±éŸ¿</a>
                        <a href="#sites" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">æ­·å²ç¾å ´</a>
                        <a href="#game" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700">è²¿æ˜“é¢¨é›²</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-[#D4A373]">
                        <span class="sr-only">Open main menu</span>
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        <div id="mobile-menu" class="md:hidden hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#explore" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700">æ¢ç´¢æ™‚ä»£</a>
                <a href="#impacts" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700">é—œéµå½±éŸ¿</a>
                <a href="#sites" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700">æ­·å²ç¾å ´</a>
                <a href="#game" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-700">è²¿æ˜“é¢¨é›²</a>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <section id="explore" class="page-section pt-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">æ¢ç´¢æ™‚ä»£ï¼šå¤šæ–¹å‹¢åŠ›çš„äº¤æœƒ</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-600">åä¸ƒä¸–ç´€çš„è‡ºç£æ˜¯ä¸–ç•Œèˆå°çš„ç¸®å½±ã€‚é»æ“Šä¸‹æ–¹çš„æ™‚é–“è»¸ï¼Œçœ‹çœ‹ä¸åŒæ™‚æœŸï¼Œå„æ–¹å‹¢åŠ›å¦‚ä½•åœ¨ç¦çˆ¾æ‘©æ²™é€™ç‰‡åœŸåœ°ä¸Šäº’å‹•ã€ç«¶çˆ­èˆ‡åˆä½œï¼Œå…±åŒå½¢å¡‘äº†è‡ºç£çš„æ—©æœŸæ­·å²ã€‚</p>
            </div>

            <div id="timeline" class="flex flex-col md:flex-row justify-center items-center gap-0 mb-12"></div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
                <div class="lg:col-span-1 flex flex-col gap-4">
                    <h3 class="text-xl font-bold text-center">èª°çš„æ™‚ä»£ï¼Ÿé»æ“Šä¾†çœ‹</h3>
                    <div id="perspective-buttons" class="grid grid-cols-2 gap-4"></div>
                    <div id="perspective-content" class="p-6 rounded-lg bg-white shadow-md min-h-[200px]">
                        <h4 id="perspective-title" class="font-bold text-lg mb-2 text-[#A97C50]"></h4>
                        <p id="perspective-text" class="text-gray-700"></p>
                    </div>
                </div>
                <div class="lg:col-span-2">
                    <h3 class="text-xl font-bold text-center mb-4">è²¿æ˜“é€ å°±çš„æ¦®æ™¯èˆ‡ä»£åƒ¹</h3>
                    <p class="text-center text-gray-600 mb-4">é¹¿çš®èˆ‡è”—ç³–æ˜¯ç•¶æ™‚æœ€é‡è¦çš„å‡ºå£å•†å“ï¼Œç‚ºè·è˜­æ±å°åº¦å…¬å¸å¸¶ä¾†å·¨å¤§åˆ©æ½¤ï¼Œå»ä¹Ÿæ·±åˆ»æ”¹è®Šäº†è‡ºç£çš„ç”Ÿæ…‹èˆ‡ç¤¾æœƒã€‚</p>
                    <div class="chart-container bg-white p-4 rounded-lg shadow-md">
                        <canvas id="tradeChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="impacts" class="page-section pt-16 hidden">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">é—œéµå½±éŸ¿ï¼šæ­·å²ç•™ä¸‹çš„å°è¨˜</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-600">æ­æ´²äººçš„åˆ°ä¾†ï¼Œåƒä¸€é¡†æŠ•å…¥æ± å¡˜çš„çŸ³å­ï¼Œæ¿€èµ·çš„æ¼£æ¼ªæ“´åŠæ”¿æ²»ã€ç¶“æ¿Ÿã€ç¤¾æœƒã€æ–‡åŒ–èˆ‡ç’°å¢ƒç­‰å„å€‹å±¤é¢ï¼Œå…¶å½±éŸ¿è‡³ä»Šä»åœ¨ã€‚</p>
            </div>
            <div class="max-w-4xl mx-auto">
                <div id="impact-tabs" class="mb-4 flex flex-wrap justify-center gap-2"></div>
                <div id="impact-content" class="p-6 rounded-lg bg-white shadow-md min-h-[300px]">
                    <h3 id="impact-title" class="text-2xl font-bold mb-4 text-[#A97C50]"></h3>
                    <p id="impact-text" class="text-gray-700 leading-relaxed"></p>
                </div>
            </div>
        </section>

        <section id="sites" class="page-section pt-16 hidden">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">æ­·å²ç¾å ´ï¼šèµ°é€²æ™‚å…‰éš§é“</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-600">å¾è‡ºå—åˆ°æ·¡æ°´ï¼Œæ­æ´²äººç•™ä¸‹çš„åŸå ¡èˆ‡éºå€ï¼Œæ˜¯è‡ºç£æ­¥å…¥ä¸–ç•Œå²çš„è¦‹è­‰ã€‚é»æ“Šå¡ç‰‡ï¼Œä¾†ä¸€å ´è·¨è¶Šæ™‚ç©ºçš„è™›æ“¬æ—…è¡Œå§ï¼</p>
            </div>
            <div id="sites-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
        </section>

        <section id="game" class="page-section pt-16 hidden">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">è²¿æ˜“é¢¨é›²ï¼šé«”é©—å•†é¤¨ç¶“ç‡Ÿ</h2>
                <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-600">æƒ³é«”é©—17ä¸–ç´€çš„è²¿æ˜“æŒ‘æˆ°å—ï¼Ÿä½ ç¾åœ¨æ˜¯è·è˜­æ±å°åº¦å…¬å¸çš„ä¸€ä½å•†äººï¼Œç›®æ¨™æ˜¯åœ¨ä¸€å¹´å…§è³ºå–æœ€å¤§åˆ©æ½¤ã€‚æ³¨æ„å¸‚å ´åƒ¹æ ¼æ³¢å‹•å’Œçªç™¼äº‹ä»¶ï¼</p>
            </div>
            <div class="max-w-3xl mx-auto bg-white p-8 rounded-lg shadow-lg">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6 text-center">
                    <div>
                        <p class="text-sm text-gray-500">æœˆä»½</p>
                        <p id="game-month" class="text-2xl font-bold">1 / 12</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">ç¾é‡‘</p>
                        <p id="game-cash" class="text-2xl font-bold">1000</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">ç¸½è³‡ç”¢</p>
                        <p id="game-assets" class="text-2xl font-bold">1000</p>
                    </div>
                </div>
                <div id="game-market" class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6"></div>
                <div id="game-message-box" class="min-h-[50px] p-4 mb-6 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 rounded-md text-center">
                    <p id="game-message">æ­¡è¿ä¾†åˆ°å¤§å“¡ï¼é–‹å§‹ä½ çš„è²¿æ˜“ä¹‹æ—…å§ã€‚</p>
                </div>
                <div class="text-center">
                    <button id="next-month-btn" class="btn-primary font-bold py-2 px-6 rounded-lg">å‰å¾€ä¸‹å€‹æœˆ</button>
                </div>
            </div>
        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const appData = {
                timeline: [
                    { id: 'period1', label: 'è·è¥¿å°å³™', years: '1624-1642', description: 'è·è˜­äººèˆ‡è¥¿ç­ç‰™äººå…ˆå¾ŒæŠµé”è‡ºç£ï¼Œåˆ†åˆ¥åœ¨å—éƒ¨èˆ‡åŒ—éƒ¨å»ºç«‹æ“šé»ï¼Œé–‹å•Ÿäº†è‡ºç£çš„å¤§èˆªæµ·æ™‚ä»£ã€‚' },
                    { id: 'period2', label: 'è·è˜­ç¨éœ¸', years: '1642-1662', description: 'è·è˜­äººé©…é€è¥¿ç­ç‰™äººå¾Œï¼Œæˆç‚ºè‡ºç£å”¯ä¸€çš„æ­æ´²çµ±æ²»å‹¢åŠ›ï¼Œç©æ¥µç™¼å±•è²¿æ˜“èˆ‡è¾²æ¥­ã€‚' },
                    { id: 'period3', label: 'æ˜é„­æ™‚æœŸ', years: '1662-1683', description: 'é„­æˆåŠŸé©…é€è·è˜­äººï¼Œè‡ºç£é€²å…¥æ¼¢äººæ”¿æ¬Šçµ±æ²»æ™‚æœŸï¼Œä¸¦å¼•å…¥å„’å®¶æ–‡åŒ–ã€‚' }
                ],
                perspectives: {
                    dutch: { title: 'ğŸ‡³ğŸ‡± è·è˜­äºº', text: 'æˆ‘å€‘æ˜¯è·è˜­æ±å°åº¦å…¬å¸(VOC)ï¼Œä¾†è‡ºç£æ˜¯ç‚ºäº†å»ºç«‹èˆ‡ä¸­åœ‹ã€æ—¥æœ¬è²¿æ˜“çš„æ“šé»ã€‚è‡ºç£çš„é¹¿çš®å’Œè”—ç³–èƒ½ç‚ºæˆ‘å€‘å¸¶ä¾†å·¨å¤§è²¡å¯Œï¼Œä½†ç®¡ç†åŸä½æ°‘å’Œæ¼¢äººç§»æ°‘æ˜¯å€‹æŒ‘æˆ°ã€‚' },
                    spanish: { title: 'ğŸ‡ªï¿½ è¥¿ç­ç‰™äºº', text: 'æˆ‘å€‘çš„ç›®æ¨™æ˜¯å¾å‘‚å®‹å³¶å‘åŒ—æ“´å¼µï¼Œå°æŠ—è·è˜­çš„å‹¢åŠ›ï¼Œä¸¦å‘æ­¤åœ°çš„åŸä½æ°‘å‚³æ’­å¤©ä¸»æ•™çš„ç¦éŸ³ã€‚æˆ‘å€‘åœ¨åŒ—è‡ºç£å»ºç«‹äº†è–è–©çˆ¾ç“¦å¤šåŸã€‚' },
                    indigenous: { title: 'ğŸ¹ åŸä½æ°‘æ—', text: 'æˆ‘å€‘æ˜¯é€™ç‰‡åœŸåœ°æœ€æ—©çš„ä¸»äººã€‚å¤–ä¾†è€…å¸¶ä¾†äº†æ–°çš„å•†å“å’Œå®—æ•™ï¼Œä½†ä¹Ÿå¥ªèµ°äº†æˆ‘å€‘çš„çµå ´å’ŒåœŸåœ°ã€‚æˆ‘å€‘æœ‰æ™‚èˆ‡ä»–å€‘åˆä½œï¼Œæœ‰æ™‚å‰‡å¥®åŠ›åæŠ—ã€‚' },
                    han: { title: 'è¾² æ¼¢äººç§»æ°‘', text: 'æˆ‘å€‘å¾å‹•äº‚çš„ä¸­åœ‹å¤§é™¸ä¾†åˆ°é€™è£¡å°‹æ±‚æ–°çš„ç”Ÿæ´»ã€‚æˆ‘å€‘ç‚ºè·è˜­äººé–‹å¢¾åœŸåœ°ã€ç¨®æ¤ç”˜è”—ï¼Œä¹Ÿå¾äº‹å„ç¨®å•†æ¥­æ´»å‹•ï¼Œé€æ¼¸å½¢æˆè‡ªå·±çš„ç¤¾ç¾¤ã€‚' }
                },
                tradeData: {
                    period1: { labels: ['é¹¿çš®', 'è”—ç³–', 'ç¨»ç±³'], data: [80, 40, 20] },
                    period2: { labels: ['é¹¿çš®', 'è”—ç³–', 'ç¨»ç±³'], data: [60, 90, 50] },
                    period3: { labels: ['é¹¿çš®', 'è”—ç³–', 'ç¨»ç±³'], data: [30, 70, 80] }
                },
                impacts: {
                    politics: { title: 'æ”¿æ²»ï¼šç¾ä»£æ²»ç†çš„é››å½¢', text: 'è·è˜­äººå»ºç«‹äº†è­°æœƒã€æ³•åº­ç­‰æ©Ÿæ§‹ï¼Œæ˜¯è‡ºç£ç¬¬ä¸€å€‹ç¾ä»£åŒ–æ²»ç†çš„é–‹ç«¯ã€‚ä»–å€‘é€éæ­¦åŠ›èˆ‡å¥‘ç´„ï¼Œå°‡åŸä½æ°‘éƒ¨è½ç´å…¥å…¶çµ±æ²»é«”ç³»ï¼Œä½†ä¹Ÿå¼•å…¥äº†åœŸåœ°è²·è³£åˆ¶åº¦ï¼Œè¡æ“Šäº†åŸä½æ°‘åŸæœ‰çš„åœŸåœ°æ¦‚å¿µã€‚' },
                    economy: { title: 'ç¶“æ¿Ÿï¼šèºä¸Šä¸–ç•Œè²¿æ˜“èˆå°', text: 'è‡ºç£æˆç‚ºè·è˜­æ±å°åº¦å…¬å¸åœ¨æ±äºçš„è½‰å£è²¿æ˜“ä¸­å¿ƒï¼Œé¹¿çš®ã€è”—ç³–ã€ç¨»ç±³ç­‰å•†å“è¢«éŠ·å¾€ä¸–ç•Œå„åœ°ã€‚ç‚ºç™¼å±•è¾²æ¥­ï¼Œè·è˜­äººå¤§é‡æ‹›å‹Ÿæ¼¢äººä¾†è‡ºé–‹å¢¾ï¼Œå¥ å®šäº†è‡ºç£è¾²æ¥­ç™¼å±•çš„åŸºç¤ã€‚' },
                    society: { title: 'ç¤¾æœƒï¼šå¤šæ—ç¾¤ç¤¾æœƒçš„å½¢æˆ', text: 'å¤§é‡æ¼¢äººç§»æ°‘çš„åˆ°ä¾†ï¼Œä½¿è‡ºç£é¦–æ¬¡å‡ºç¾åŸä½æ°‘ã€æ­æ´²äººã€æ¼¢äººç­‰å¤šæ—ç¾¤å…±å­˜çš„ç¤¾æœƒçµæ§‹ã€‚æ¼¢äººç¤¾ç¾¤çš„æ“´å¤§ä¹Ÿå£“ç¸®äº†åŸä½æ°‘çš„ç”Ÿæ´»ç©ºé–“ï¼Œå°è‡´æ—ç¾¤è¡çªæ™‚æœ‰ç™¼ç”Ÿã€‚' },
                    culture: { title: 'æ–‡åŒ–ï¼šæ–°ä¿¡ä»°èˆ‡æ–°æ–‡å­—', text: 'æ­æ´²å‚³æ•™å£«å‚³å…¥åŸºç£æ•™èˆ‡å¤©ä¸»æ•™ã€‚ç‚ºäº†å‚³æ•™ï¼Œè·è˜­äººç‚ºè¥¿æ‹‰é›…æ—å‰µé€ äº†ç¾…é¦¬å­—æ‹¼éŸ³çš„ã€Œæ–°æ¸¯æ–‡ã€ï¼Œé€™æ˜¯è‡ºç£å²ä¸Šç¬¬ä¸€å€‹ç³»çµ±æ€§çš„æ–‡å­—ï¼Œä¸åƒ…ç”¨æ–¼å®—æ•™ï¼Œä¹Ÿç”¨æ–¼æ°‘é–“çš„å¥‘ç´„æ›¸å¯«ã€‚' },
                    environment: { title: 'ç’°å¢ƒï¼šè³‡æºé–‹ç™¼çš„ä»£åƒ¹', text: 'å•†æ¥­è²¿æ˜“çš„èˆˆç››ï¼Œç‰¹åˆ¥æ˜¯é¹¿çš®è²¿æ˜“ï¼Œå°è‡´è‡ºç£æ¢…èŠ±é¹¿å› è¢«å¤§é‡æ•æ®ºè€Œæ•¸é‡éŠ³æ¸›ï¼Œå°è‡ªç„¶ç”Ÿæ…‹é€ æˆäº†ä¸å¯é€†çš„ç ´å£ã€‚é€™æ˜¯è‡ºç£æ—©æœŸå…¨çƒåŒ–ä»˜å‡ºçš„ç’°å¢ƒä»£åƒ¹ã€‚' }
                },
                sites: [
                    { id: 'anping', name: 'å®‰å¹³å¤å ¡', originalName: 'ç†±è˜­é®åŸ', builder: 'è·è˜­äºº', year: 1624, location: 'è‡ºå—å¸‚å®‰å¹³å€', description: 'è‡ºç£æœ€æ—©çš„è¦å¡ï¼Œæ›¾æ˜¯è·è˜­çµ±æ²»è‡ºç£çš„æ”¿æ²»åŠè»äº‹æ ¸å¿ƒã€‚å…¶ç³¯ç±³ã€ç³–æ¼¿ã€èšµæ®¼ç°ç Œæˆçš„åŸç‰†æ˜¯æœ€å¤§ç‰¹è‰²ã€‚' },
                    { id: 'chihkan', name: 'èµ¤å´æ¨“', originalName: 'æ™®ç¾…æ°‘é®åŸ', builder: 'è·è˜­äºº', year: 1653, location: 'è‡ºå—å¸‚ä¸­è¥¿å€', description: 'ä½œç‚ºè¡Œæ”¿èˆ‡å•†æ¥­ä¸­å¿ƒè€Œå»ºã€‚é„­æˆåŠŸä¾†è‡ºå¾Œï¼Œå°‡æ­¤åœ°æ”¹ç‚ºæ‰¿å¤©åºœï¼Œæˆç‚ºç•¶æ™‚çš„æœ€é«˜è¡Œæ”¿æ©Ÿé—œã€‚' },
                    { id: 'hongmao', name: 'ç´…æ¯›åŸ', originalName: 'è–å¤šæ˜å“¥åŸ', builder: 'è¥¿ç­ç‰™/è·è˜­', year: '1628/1644', location: 'æ–°åŒ—å¸‚æ·¡æ°´å€', description: 'æœ€åˆç”±è¥¿ç­ç‰™äººå»ºé€ ï¼Œå¾Œç”±è·è˜­äººé‡å»ºã€‚å› æ¼¢äººç¨±è·è˜­äººç‚ºã€Œç´…æ¯›ã€è€Œå¾—åï¼Œæ˜¯è‡ºç£ç¾å­˜æœ€å¤è€çš„å®Œæ•´è¥¿å¼å»ºç¯‰ã€‚' },
                    { id: 'heping', name: 'å’Œå¹³å³¶éºå€', originalName: 'è–è–©çˆ¾ç“¦å¤šåŸ', builder: 'è¥¿ç­ç‰™äºº', year: 1626, location: 'åŸºéš†å¸‚å’Œå¹³å³¶', description: 'è¥¿ç­ç‰™äººåœ¨åŒ—è‡ºç£çš„æ‹“æ®–æ“šé»ï¼Œèˆ‡å—éƒ¨çš„ç†±è˜­é®åŸé™é™ç›¸å°ã€‚è€ƒå¤ç™¼ç¾äº†æ•™å ‚ã€å¢“è‘¬ç­‰é‡è¦éºè·¡ã€‚' }
                ],
                game: {
                    goods: [
                        { id: 'deerskin', name: 'é¹¿çš®', basePrice: 50, stock: 0 },
                        { id: 'sugar', name: 'è”—ç³–', basePrice: 30, stock: 0 },
                        { id: 'silk', name: 'çµ²ç¶¢', basePrice: 80, stock: 0 },
                        { id: 'spice', name: 'é¦™æ–™', basePrice: 100, stock: 0 },
                    ],
                    events: [
                        { message: 'é¢±é¢¨ä¾†è¥²ï¼Œæ‰€æœ‰å•†å“åƒ¹æ ¼ä¸Šæ¼²ï¼', effect: 1.2 },
                        { message: 'åŸä½æ°‘åæŠ—ï¼Œé¹¿çš®ä¾›æ‡‰æ¸›å°‘ï¼Œåƒ¹æ ¼é£†å‡ï¼', good: 'deerskin', effect: 1.5 },
                        { message: 'èˆ‡ä¸­åœ‹è²¿æ˜“é †æš¢ï¼Œçµ²ç¶¢å¤§é‡æ¹§å…¥ï¼Œåƒ¹æ ¼ä¸‹è·Œã€‚', good: 'silk', effect: 0.7 },
                        { message: 'è±æ”¶ä¹‹å¹´ï¼Œè”—ç³–ç”¢é‡å¤§å¢ï¼Œåƒ¹æ ¼ä¾¿å®œã€‚', good: 'sugar', effect: 0.8 },
                        { message: 'æµ·ç›œçŒ–ç—ï¼Œè²¿æ˜“å—é˜»ï¼Œé¦™æ–™åƒ¹æ ¼å¤§æ¼²ã€‚', good: 'spice', effect: 1.4 },
                        { message: 'å¸‚å ´å¹³ç©©ï¼Œç„¡äº‹ç™¼ç”Ÿã€‚', effect: 1.0 }
                    ]
                }
            };

            let currentState = {
                activeSection: 'explore',
                activeTimeline: 'period1',
                activePerspective: 'dutch',
                activeImpact: 'politics',
                game: {
                    month: 1,
                    cash: 1000,
                    goods: {}
                }
            };
            
            const tradeChartInstance = null;

            function init() {
                setupNav();
                setupTimeline();
                setupPerspectiveButtons();
                setupImpactTabs();
                setupSitesGrid();
                initGame();
                updateView();
            }
            
            function setupNav() {
                const navLinks = document.querySelectorAll('.nav-link');
                const mobileMenuButton = document.getElementById('mobile-menu-button');
                const mobileMenu = document.getElementById('mobile-menu');

                navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const sectionId = new URL(link.href).hash.substring(1);
                        currentState.activeSection = sectionId;
                        updateView();
                        if (!mobileMenu.classList.contains('hidden')) {
                            mobileMenu.classList.add('hidden');
                        }
                    });
                });
                
                mobileMenuButton.addEventListener('click', () => {
                    mobileMenu.classList.toggle('hidden');
                });
            }

            function setupTimeline() {
                const timelineContainer = document.getElementById('timeline');
                timelineContainer.innerHTML = appData.timeline.map((period, index) => `
                    <div class="timeline-segment cursor-pointer flex-1 text-center p-4 transition-all duration-300 ${index < appData.timeline.length - 1 ? 'md:border-r-2 border-gray-300' : ''}" data-id="${period.id}">
                        <div class="timeline-year font-bold text-lg text-[#A97C50]">${period.years}</div>
                        <div class="timeline-label text-sm text-gray-600">${period.label}</div>
                    </div>
                `).join('');
                timelineContainer.querySelectorAll('.timeline-segment').forEach(seg => {
                    seg.addEventListener('click', () => {
                        currentState.activeTimeline = seg.dataset.id;
                        updateView();
                    });
                });
            }

            function setupPerspectiveButtons() {
                const container = document.getElementById('perspective-buttons');
                container.innerHTML = Object.keys(appData.perspectives).map(key => {
                    const p = appData.perspectives[key];
                    return `<button class="perspective-btn p-4 rounded-lg shadow-sm transition-all duration-300 bg-white" data-id="${key}">${p.title}</button>`;
                }).join('');
                container.querySelectorAll('.perspective-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        currentState.activePerspective = btn.dataset.id;
                        updateView();
                    });
                });
            }
            
            function setupImpactTabs() {
                const container = document.getElementById('impact-tabs');
                container.innerHTML = Object.keys(appData.impacts).map(key => {
                    const impact = appData.impacts[key];
                    return `<button class="tab-button px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200" data-id="${key}">${impact.title.split('ï¼š')[0]}</button>`;
                }).join('');
                container.querySelectorAll('.tab-button').forEach(btn => {
                    btn.addEventListener('click', () => {
                        currentState.activeImpact = btn.dataset.id;
                        updateView();
                    });
                });
            }
            
            function setupSitesGrid() {
                const container = document.getElementById('sites-grid');
                container.innerHTML = appData.sites.map(site => `
                    <div class="card rounded-lg overflow-hidden shadow-lg">
                        <div class="p-6">
                            <h3 class="font-bold text-xl mb-2 text-[#A97C50]">${site.name}</h3>
                            <p class="text-gray-500 text-sm mb-2">${site.originalName} (${site.year})</p>
                            <p class="text-gray-700 text-base">${site.description}</p>
                            <div class="mt-4 pt-4 border-t border-gray-200">
                                <p class="text-xs text-gray-600"><strong>å»ºç«‹è€…:</strong> ${site.builder}</p>
                                <p class="text-xs text-gray-600"><strong>åœ°é»:</strong> ${site.location}</p>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            function updateView() {
                updateNav();
                updatePageSections();
                
                if (currentState.activeSection === 'explore') {
                    updateExploreSection();
                } else if (currentState.activeSection === 'impacts') {
                    updateImpactsSection();
                } else if (currentState.activeSection === 'game') {
                    updateGameUI();
                }
            }
            
            function updateNav() {
                document.querySelectorAll('.nav-link').forEach(link => {
                    if (link.href.endsWith(`#${currentState.activeSection}`)) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            function updatePageSections() {
                document.querySelectorAll('.page-section').forEach(section => {
                    if (section.id === currentState.activeSection) {
                        section.classList.remove('hidden');
                    } else {
                        section.classList.add('hidden');
                    }
                });
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            function updateExploreSection() {
                document.querySelectorAll('#timeline .timeline-segment').forEach(seg => {
                    seg.classList.toggle('active', seg.dataset.id === currentState.activeTimeline);
                });
                
                document.querySelectorAll('#perspective-buttons .perspective-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.id === currentState.activePerspective);
                });

                const perspectiveData = appData.perspectives[currentState.activePerspective];
                document.getElementById('perspective-title').textContent = perspectiveData.title;
                document.getElementById('perspective-text').textContent = perspectiveData.text;

                renderTradeChart(currentState.activeTimeline);
            }

            function updateImpactsSection() {
                document.querySelectorAll('#impact-tabs .tab-button').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.id === currentState.activeImpact);
                });
                const impactData = appData.impacts[currentState.activeImpact];
                document.getElementById('impact-title').textContent = impactData.title;
                document.getElementById('impact-text').textContent = impactData.text;
            }

            let myTradeChart = null;
            function renderTradeChart(periodId) {
                const ctx = document.getElementById('tradeChart').getContext('2d');
                const chartData = appData.tradeData[periodId];
                
                if (myTradeChart) {
                    myTradeChart.destroy();
                }

                myTradeChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: chartData.labels,
                        datasets: [{
                            label: 'è²¿æ˜“é‡æŒ‡æ•¸',
                            data: chartData.data,
                            backgroundColor: ['#D4A373', '#A97C50', '#8C663F'],
                            borderColor: ['#C38E5F', '#986F4A', '#7B5836'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return ` ${context.dataset.label}: ${context.raw}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'ç›¸å°è²¿æ˜“é‡'
                                }
                            }
                        }
                    }
                });
            }
            
            function initGame() {
                const goods = appData.game.goods;
                goods.forEach(g => {
                    currentState.game.goods[g.id] = { stock: 0, price: g.basePrice };
                });
                document.getElementById('next-month-btn').addEventListener('click', nextMonth);
                updateGameUI();
            }

            function updateGameUI() {
                const game = currentState.game;
                document.getElementById('game-month').textContent = `${game.month} / 12`;
                document.getElementById('game-cash').textContent = `ğŸ’° ${game.cash}`;
                
                const marketContainer = document.getElementById('game-market');
                marketContainer.innerHTML = '';
                let assetValue = game.cash;

                appData.game.goods.forEach(good => {
                    const currentGood = game.goods[good.id];
                    assetValue += currentGood.stock * currentGood.price;
                    
                    marketContainer.innerHTML += `
                        <div class="p-4 border rounded-lg">
                            <h4 class="font-bold text-lg">${good.name}</h4>
                            <p class="text-sm text-gray-500 mb-2">æŒæœ‰: ${currentGood.stock} | åƒ¹æ ¼: ${currentGood.price}</p>
                            <div class="flex gap-2">
                                <button class="flex-1 text-sm btn-primary py-1 px-2 rounded" onclick="buyGood('${good.id}')">è²·å…¥</button>
                                <button class="flex-1 text-sm bg-gray-200 text-gray-700 py-1 px-2 rounded hover:bg-gray-300" onclick="sellGood('${good.id}')">è³£å‡º</button>
                            </div>
                        </div>
                    `;
                });
                document.getElementById('game-assets').textContent = `ğŸ’ ${assetValue}`;
                
                if (game.month > 12) {
                    endGame();
                }
            }
            
            window.buyGood = function(goodId) {
                const game = currentState.game;
                const good = game.goods[goodId];
                if (game.cash >= good.price) {
                    game.cash -= good.price;
                    good.stock += 1;
                    updateGameUI();
                } else {
                    document.getElementById('game-message').textContent = 'ç¾é‡‘ä¸è¶³ï¼';
                }
            }

            window.sellGood = function(goodId) {
                const game = currentState.game;
                const good = game.goods[goodId];
                if (good.stock > 0) {
                    game.cash += good.price;
                    good.stock -= 1;
                    updateGameUI();
                } else {
                    document.getElementById('game-message').textContent = 'æ²’æœ‰åº«å­˜å¯ä»¥è³£äº†ï¼';
                }
            }
            
            function nextMonth() {
                const game = currentState.game;
                if (game.month > 12) return;
                
                game.month++;
                
                const event = appData.game.events[Math.floor(Math.random() * appData.game.events.length)];
                document.getElementById('game-message').textContent = `æœ¬æœˆäº‹ä»¶ï¼š${event.message}`;

                appData.game.goods.forEach(good => {
                    let priceChange = (Math.random() - 0.4) * 0.3 + 1; // Fluctuation between 0.7 and 1.3
                    if (event.good === good.id || !event.good) {
                        priceChange *= event.effect;
                    }
                    const newPrice = Math.max(5, Math.round(game.goods[good.id].price * priceChange));
                    game.goods[good.id].price = newPrice;
                });
                
                updateGameUI();
            }

            function endGame() {
                const game = currentState.game;
                const finalAssets = parseInt(document.getElementById('game-assets').textContent.replace('ğŸ’ ', ''));
                let endMessage = `éŠæˆ²çµæŸï¼ä½ çš„æœ€çµ‚è³‡ç”¢æ˜¯ ${finalAssets}ã€‚`;
                if (finalAssets > 2000) {
                    endMessage += 'ä½ çœŸæ˜¯å€‹è²¿æ˜“å¥‡æ‰ï¼';
                } else if (finalAssets > 1000) {
                    endMessage += 'ä¸éŒ¯çš„æˆç¸¾ï¼Œä½ æˆåŠŸç²åˆ©äº†ã€‚';
                } else {
                    endMessage += 'çœ‹ä¾†ç¶“å•†ä¸æ˜“ï¼Œä¸‹æ¬¡å†åŠªåŠ›å§ï¼';
                }
                document.getElementById('game-message').textContent = endMessage;
                document.getElementById('next-month-btn').disabled = true;
                document.getElementById('next-month-btn').textContent = 'é‡æ–°é–‹å§‹';
                document.getElementById('next-month-btn').onclick = () => window.location.reload();
            }

            init();
        });
    </script>
</body>
</html>
ï¿½
